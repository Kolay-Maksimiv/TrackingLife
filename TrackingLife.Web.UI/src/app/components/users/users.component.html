<!-- begin panel -->
<span *ngIf="isLoading" class="spinner-small"></span>
<panel>
  <ng-container header>
    <h4 class="panel-title-users">Users <span class="label label-success m-l-5 t-minus-1 pointer"
        [routerLinkActive]="['link-active']" [routerLink]="['create']">NEW</span></h4>
  </ng-container>
  <div class="row m-b-10 p-r-10 get-user-button">
    <div class="m-r-15 pointer" [ngClass]="{'activeUser': !filter.isRemoved}" (click)="getActiveUser()">Active Users</div>
    <div class="pointer" [ngClass]="{'activeUser': filter.isRemoved}" (click)="getArchiveUser()">Archived Users</div>
  </div>
  <div class="row m-b-15">
    <div class="col-md-4">
      <input class="form-control" placeholder="Search" [formControl]="searchByName" />
    </div>
    <div class="col-md-4">
      <input class="form-control" placeholder="Filter Users" [formControl]="searchByEmail" />
    </div>
    <div class="col-md-2">
      <select class="form-control" [formControl]="searchByAccessLevel">
        <option value="" selected>Access Level</option>
        <option value="User">User</option>
        <option value="System Admin">System Admin</option>
      </select>
    </div>
    <div class="col-md-2">
      <select class="form-control"  [formControl]="searchByComnany">
        <option value="" selected>All company</option>
        <option *ngFor="let company of companies" [ngValue]="company.name">{{ company.name }}</option>
      </select>
    </div>
  </div>
  <!-- begin table-responsive -->
  <div class="table-responsive" *ngIf='users'>
    <table class="table table-striped m-b-0"  style="overflow-x: hidden;">
      <thead>
        <tr class="table-head">
          <th width="65px"></th>
          <th width="125px"></th>
          <th width="250px"><b>Name</b></th>
          <th><b>Access Level</b></th>
          <th><b>Company</b></th>
          <th><b>Date Added</b></th>
          <th  width="280px"><a type="button" class="btn btn-outline-primary"  (click)="clickDownloadCsv()" >Export</a></th>
        </tr>
      </thead>
      <tbody>
        <tr class="tr-custom-style" *ngFor='let user of users'>

          <td class="profile-id">{{ user.profileId }}</td>

          <td class="avatar-block">
            <img  src ="{{ user.imageUrl || 'assets/img/default/Group.png' }}" width="65px" height="65px" />
          </td>

          <td class="p-t-13 ">
            <div class="m-b-7" style="font-size: 16px;">
              <b>{{ user.firstName }} {{ user.lastName }}</b>
            </div>
            <div class="m-b-7" style="font-size: 14px;">
              {{ user.phoneNumber }}
            </div>
            <div class="m-b-7" style="font-size: 16px;">
              {{ user.email }}
            </div>
          </td>

          <td>{{ user.roles }}</td>
          <td>{{ user.companyName }}</td>
          <td>{{ user.dateCreated | date:'dd.MM.yyyy' }}</td>
          <td class="with-btn" nowrap>
            <a class="btn custom-btn edit-btn m-r-10" [routerLinkActive]="['link-active']"
              [routerLink]="['edit', user.profileId]">Edit</a>
            <a class="btn custom-btn archive-btn" *ngIf="!isActivate" (click)="deleteUser(user.id)">Archive</a>
            <a class="btn custom-btn archive-btn" *ngIf="isActivate" (click)="activateUser(user.id)">Activate</a>
          </td>
        </tr>
      </tbody>
    </table>
    <ng-container footer>
      <hr />
      <ngb-pagination class="d-flex justify-content-center" [collectionSize]="length" [pageSize]="itemsPerPage"
        [(page)]="page" [maxSize]="5" [rotate]="false" (pageChange)="loadPage($event)" [boundaryLinks]="false">
        <ng-template class="page-arrow" ngbPaginationPrevious><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"/>
        </svg> Prev</ng-template>
        <ng-template ngbPaginationNext class="page-arrow">Next <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>
        </svg></ng-template>
        <ng-template ngbPaginationEllipsis>...</ng-template>
      </ngb-pagination>
    </ng-container>
  </div>
  <!-- end table-responsive -->
</panel>
<!-- end panel -->